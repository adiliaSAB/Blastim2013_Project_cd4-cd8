position = "fill",
width = 1) +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot() +
geom_bar(data = Tcell_range,
aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Этнические группы",
subtitle = "Распределение по уровням cd4/cd8") +
xlab("cd4/cd8") +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
Tcell %>%  #корреляция
select(cd4_cd8_ratio, emphysema_severity) %>%
drop_na() %>%
cor()
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2") +
theme(legend.position = "bottom") +
labs(title = "Gender of participants, by cd4/c48")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2") +
theme(legend.position = "bottom") +
labs(title = "Gender of participants, by cd4/c48") +
scale_(x|y)_continuous()
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_minimal()  +
scale_fill_brewer(palette = "Dark2") +
theme(legend.position = "bottom") +
labs(title = "Gender of participants, by cd4/c48")
geom_boxplot()
#Sex
ggplot() +
geom_boxplot(data = Tcell_range,
aes(x = cd4_cd8_ratio_range y = sex, fill = cd4_cd8_ratio_range))
#Sex
ggplot() +
geom_boxplot(data = Tcell_range,
aes(x = cd4_cd8_ratio_range, y = sex, fill = cd4_cd8_ratio_range))
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
source("~/.active-rstudio-document", echo=TRUE)
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous(trans = "identity") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_y_continuous(trans = "identity") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(y = NULL)
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(y = NULL)+
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL)+
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL)+
theme_void()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL)+
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#DONEage_at_enrollment
ggplot(data = Tcell_range,
aes(x = cd4_cd8_ratio_range,
y = age_at_enrollment,
fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1")))) +
geom_violin(scale = "count",
adjust = 0.5) +
geom_boxplot(alpha = 0,
show.legend = FALSE) +
labs(title = "Возраст добровольцев",
subtitle = "по группам cd4/cd8") +
xlab("cd4/cd8") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) + #подписать столбцы
#scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender")+
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
guides(colour = guide_legend(order = c(",0.4", "0.4-1", ">1"))) +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
guides(guide_legend(order = c(",0.4", "0.4-1", ">1"))) +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
guides(legend.position = "bottom",
guide_legend(order = c("<0.4", "0.4-1", ">1"))) +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +
geom_bar(aes(y = sex, fill = cd4_cd8_ratio_range),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
theme_classic(legend.position = "bottom")  +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +   #порядок в легенде, ужать столбцы, легенду вниз
geom_bar(aes(y = sex, fill = factor(cd4_cd8_ratio_range, levels =
c("<0.4", "0.4-1", ">1"))),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot() +
geom_bar(data = Tcell_range,
aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Этнические группы",
subtitle = "Распределение по уровням cd4/cd8") +
xlab("cd4/cd8") +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +   #порядок в легенде, ужать столбцы, легенду вниз
geom_bar(aes(y = sex, fill = factor(cd4_cd8_ratio_range, levels =
c("<0.4", "0.4-1", ">1"))),
position = "fill") +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
labs(x = NULL, y = "Gender") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic()  +
scale_fill_brewer(palette = "Dark2")
#scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
#DONEage_at_enrollment
ggplot(data = Tcell_range,
aes(x = cd4_cd8_ratio_range,
y = age_at_enrollment,
fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1")))) +
geom_violin(scale = "count",
adjust = 0.5) +
geom_boxplot(alpha = 0,
show.legend = FALSE) +
labs(title = "Возраст добровольцев",
subtitle = "по группам cd4/cd8") +
xlab("cd4/cd8") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) +
#scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
#Sex
ggplot(data = Tcell_range) +   #почему заливка в другом порядке, ужать столбцы, легенду вниз
geom_bar(aes(y = sex, fill = factor(cd4_cd8_ratio_range, levels =
c("<0.4", "0.4-1", ">1"))),
position = "fill") +
labs(title = "Gender of participant, by cd4/cd8",
x = NULL, y = "Gender") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic()  +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot() +
geom_bar(data = Tcell_range,
aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Этнические группы",
subtitle = "Распределение по уровням cd4/cd8") +
xlab("cd4/cd8") +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) +
scale_color_brewer(palette = "Dark2") +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot(data = Tcell_range) +
geom_bar(aes(y = race_ethnicity, fill = factor(cd4_cd8_ratio_range,
levels =c("<0.4", "0.4-1", ">1")),
position = "fill"))  +
labs(title = "Race etnicity, by cd4/cd8",
x = NULL, y = "Race ethnicity") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic() +
scale_x_continuous() +
scale_y_continuous(label = c("1", "2", "3", "4","1")) +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot(data = Tcell_range) +
geom_bar(aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Race ethnicity, by cd4/cd8", x = "cd4/cd8") +
theme_classic() +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot(data = Tcell_range) +
geom_bar(aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Race ethnicity, by cd4/cd8",
x = "cd4/cd8", y = "Race ethnicity") +
theme_classic() +
scale_fill_brewer(palette = "Dark2")
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range) +
geom_quantile(aes(x = cd4_cd8_ratio, y = BMI),
group = cd4_cd8_ratio_range) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic() +
scale_fill_brewer(palette = "Dark2")
source("~/.active-rstudio-document", echo=TRUE)
#DONEcd4/cd8 groups
ggplot() +
geom_bar(data = Tcell_range,
aes(x = "",
fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1")))) +
coord_polar(theta = "y") +
labs(title = "Распределение по группам cd4/cd8") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_void() +
scale_fill_brewer(palette = "Dark2")
#DONEage_at_enrollment
ggplot(data = Tcell_range,
aes(x = cd4_cd8_ratio_range,
y = age_at_enrollment,
fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1")))) +
geom_violin(scale = "count",
adjust = 0.5) +
geom_boxplot(alpha = 0,
show.legend = FALSE) +
labs(title = "Возраст добровольцев",
subtitle = "по группам cd4/cd8") +
xlab("cd4/cd8") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic() +
scale_x_discrete(limits=c("<0.4", "0.4-1", ">1")) +
scale_fill_brewer(palette = "Dark2")
#DONESex
ggplot(data = Tcell_range) +   #почему заливка в другом порядке, ужать столбцы, легенду вниз
geom_bar(aes(y = sex, fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1"))),
position = "fill") +
labs(title = "Gender of participant, by cd4/cd8",
x = NULL, y = "Gender") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic()  +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("female", "male")) +
scale_fill_brewer(palette = "Dark2")
#DONEcd4_cd8_ratio: race_ethnicity
ggplot(data = Tcell_range) +
geom_bar(aes(x = cd4_cd8_ratio_range, fill = race_ethnicity),
position = "dodge")  +
labs(title = "Race ethnicity, by cd4/cd8",
x = "cd4/cd8", y = "Race ethnicity") +
theme_classic() +
scale_fill_brewer(palette = "Dark2")
#Inhalation
ggplot(data = Tcell_range) +
geom_bar(aes(y = inhalational_drugs, fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1"))),
position = "fill") +
labs(title = "Inhalation, by cd4/cd8",
x = NULL, y = "Inhalation") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic()  +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("no", "yes")) +
scale_fill_brewer(palette = "Dark2")
#iv drug use
ggplot(data = Tcell_range) +
geom_bar(aes(y = ivdu, fill = factor(cd4_cd8_ratio_range,
levels = c("<0.4", "0.4-1", ">1"))),
position = "fill") +
labs(title = "iv drug use, by cd4/cd8",
x = NULL, y = "ivdu") +
guides(fill = guide_legend(title = "cd4/cd8")) +
theme_classic()  +
scale_x_continuous() +
scale_y_continuous(breaks = c(0, 1), label = c("no", "yes")) +
scale_fill_brewer(palette = "Dark2")
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_smooth(method = "lm", colour = "#BA1825", size = 2) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_line(group = rep(cd4_cd8_ratio_range),
colour = group,
linewidth = 4) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_line(group_by((cd4_cd8_ratio_range)),
colour = group,
linewidth = 4) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_line(colour = variable,
linewidth = 4) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_line(linewidth = 4) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, x = cd4_cd8_ratio, y = BMI) +
geom_line() +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio, y = BMI)) +
geom_line(group = rep(cd4_cd8_ratio_range),
colour = group,
linewidth = 5) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio, y = BMI)) +
geom_line(group = cd4_cd8_ratio_range,
colour = group,
linewidth = 5) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio, y = BMI)) +
geom_line(group_by(cd4_cd8_ratio_range),
colour = group,
linewidth = 5) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio, y = BMI)) +
geom_line(linewidth = 5) +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio, y = BMI)) +
geom_line() +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
#cd4_cd8_ratio: BMI
ggplot(data = Tcell_range, aes(x = cd4_cd8_ratio_range, y = BMI)) +
geom_density(alpha=0.3)() +
labs(title = "BMI by cd4/cd8",
x = "cd4/cd8", y = "BMI") +
theme_classic()
source("~/.active-rstudio-document", echo=TRUE)
summary(Tcell_lm)
Tcell_lm$residuals <-  residuals(Tcell_lm) #R-test
Tcell
Tcell_lm$fitted <-  fitted(Tcell_lm)
View(Tcell_lm)
Tcell_range %>%
transmute(cd4_cd8_ratio - (Tcell_lm$residuals + Tcell_lm$fitted))
rss <- sum(Tcell_lm$residuals^2) #Необъясненная регрессия
rss
tss <- sum(Tcell_range$cd4_cd8_ratio - mean(Tcell_range$cd4_cd8_ratio))^2
tss
1-rss/tss
summary(Tcell_lm)
source("~/.active-rstudio-document", echo=TRUE)
